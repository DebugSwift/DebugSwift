desc "Run the tests and prepare for Danger"
lane :test do
  # Skip the gym step - we don't need to archive for running tests
  # gym(
  #   project:           "Example.xcodeproj",
  #   scheme:            "Example",
  #   clean:             true,
  #   output_directory:  "fastlane/test_output",
  #   output_name:       "Example.xcresult",
  #   skip_codesigning:  true
  # )
  
  # Run tests
  scan(
    project:                          "Example.xcodeproj",
    scheme:                           "Example",
    derived_data_path:                "fastlane/test_output",
    clean:                            true,
    result_bundle:                    true,
    code_coverage:                    true,
    devices:                          ['iPhone 16'],
    skip_package_dependencies_resolution: false,
    disable_package_automatic_updates: true
  )
end
